<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>wal - The Go Programming Language</title>

<link type="text/css" rel="stylesheet" href="../../../../../../lib/godoc/style.css">


<script>window.initFuncs = [];</script>

<script src="../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.11.5";</script>
<script src="../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/">The Go Programming Language</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/">Go</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">
<a href="http://localhost:6060/doc/">Documents</a>
<a href="../../../../../index.html">Packages</a>
<a href="http://localhost:6060/project/">The Project</a>
<a href="http://localhost:6060/help/">Help</a>

<a href="http://localhost:6060/blog/">Blog</a>


<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package wal
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/SmartBFT-Go/consensus/pkg/wal"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
				<dd><a href="index.html#pkg-constants">Constants</a></dd>
			
			
				<dd><a href="index.html#pkg-variables">Variables</a></dd>
			
			
				
				<dd><a href="index.html#Repair">func Repair(logger api.Logger, dirPath string) error</a></dd>
			
			
				
				<dd><a href="index.html#LogRecordCRC">type LogRecordCRC</a></dd>
				
				
			
				
				<dd><a href="index.html#LogRecordHeader">type LogRecordHeader</a></dd>
				
				
			
				
				<dd><a href="index.html#LogRecordLength">type LogRecordLength</a></dd>
				
				
			
				
				<dd><a href="index.html#LogRecordReader">type LogRecordReader</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewLogRecordReader">func NewLogRecordReader(logger api.Logger, fileName string) (*LogRecordReader, error)</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#LogRecordReader.CRC">func (r *LogRecordReader) CRC() uint32</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#LogRecordReader.Close">func (r *LogRecordReader) Close() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#LogRecordReader.Read">func (r *LogRecordReader) Read() (*protos.LogRecord, error)</a></dd>
				
			
				
				<dd><a href="index.html#Options">type Options</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#DefaultOptions">func DefaultOptions() *Options</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Options.String">func (o *Options) String() string</a></dd>
				
			
				
				<dd><a href="index.html#WriteAheadLogFile">type WriteAheadLogFile</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Create">func Create(logger api.Logger, dirPath string, options *Options) (*WriteAheadLogFile, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#InitializeAndReadAll">func InitializeAndReadAll(logger api.Logger, walDir string, options *Options) (writeAheadLog *WriteAheadLogFile, initialState [][]byte, err error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Open">func Open(logger api.Logger, dirPath string, options *Options) (*WriteAheadLogFile, error)</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WriteAheadLogFile.Append">func (w *WriteAheadLogFile) Append(data []byte, truncateTo bool) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WriteAheadLogFile.CRC">func (w *WriteAheadLogFile) CRC() uint32</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WriteAheadLogFile.Close">func (w *WriteAheadLogFile) Close() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WriteAheadLogFile.ReadAll">func (w *WriteAheadLogFile) ReadAll() ([][]byte, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WriteAheadLogFile.TruncateTo">func (w *WriteAheadLogFile) TruncateTo() error</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go">reader.go</a>
			
				<a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/util.go">util.go</a>
			
				<a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go">writeaheadlog.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
			<h2 id="pkg-constants">Constants</h2>
			
				
				<pre>const (
    <span id="FileSizeBytesDefault">FileSizeBytesDefault</span>   <a href="http://localhost:6060/pkg/builtin/#int64">int64</a> = 64 * 1024 * 1024 <span class="comment">// 64MB</span>
    <span id="BufferSizeBytesDefault">BufferSizeBytesDefault</span> <a href="http://localhost:6060/pkg/builtin/#int64">int64</a> = 1024 * 1024      <span class="comment">// 1MB</span>
)</pre>
			
		
		
			<h2 id="pkg-variables">Variables</h2>
			
				
				<pre>var (
    <span id="ErrCRC">ErrCRC</span>       = <a href="http://localhost:6060/pkg/github.com/pkg/errors/">errors</a>.<a href="http://localhost:6060/pkg/github.com/pkg/errors/#New">New</a>(&#34;wal: crc verification failed&#34;)
    <span id="ErrWriteOnly">ErrWriteOnly</span> = <a href="http://localhost:6060/pkg/github.com/pkg/errors/">errors</a>.<a href="http://localhost:6060/pkg/github.com/pkg/errors/#New">New</a>(&#34;wal: in WRITE mode&#34;)
    <span id="ErrReadOnly">ErrReadOnly</span>  = <a href="http://localhost:6060/pkg/github.com/pkg/errors/">errors</a>.<a href="http://localhost:6060/pkg/github.com/pkg/errors/#New">New</a>(&#34;wal: in READ mode&#34;)

    <span id="ErrWALAlreadyExists">ErrWALAlreadyExists</span> = <a href="http://localhost:6060/pkg/github.com/pkg/errors/">errors</a>.<a href="http://localhost:6060/pkg/github.com/pkg/errors/#New">New</a>(&#34;wal: is already exists&#34;)
)</pre>
			
		
		
			
			
			<h2 id="Repair">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=7596:7648#L245">Repair</a>
				<a class="permalink" href="index.html#Repair">&#xb6;</a>
				
				
			</h2>
			<pre>func Repair(logger <a href="../api/index.html">api</a>.<a href="../api/index.html#Logger">Logger</a>, dirPath <a href="http://localhost:6060/pkg/builtin/#string">string</a>) <a href="http://localhost:6060/pkg/builtin/#error">error</a></pre>
			<p>
Repair tries to repair the last file of a WAL, in case an Open() comes back with a io.ErrUnexpectedEOF,
which indicates the possibility to fix the WAL.
</p>
<p>
After a crash, the last log file in the WAL may be left in a state where an attempt tp reopen will result in
the last Read() returning an error. This is because of several reasons:
- we use pre-allocated / recycled files, the files have a &#34;garbage&#34; tail
- the last write may have been torn
- the failure might have occurred when the log file was being prepared (no anchor)
</p>
<p>
The Repair() tries to repair the last file of the wal by truncating after the last good record.
Before doing so it copies the bad file to a side location for later analysis by operators.
</p>
<p>
logger: reference to a Logger implementation.
dirPath: directory path of the WAL.
return: an error if repair was not successful.
</p>

			
			

		
		
			
			
			<h2 id="LogRecordCRC">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=1118:1142#L42">LogRecordCRC</a>
				<a class="permalink" href="index.html#LogRecordCRC">&#xb6;</a>
				
				
			</h2>
			
			<pre>type LogRecordCRC <a href="http://localhost:6060/pkg/builtin/#uint32">uint32</a></pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="LogRecordHeader">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=1242:1269#L45">LogRecordHeader</a>
				<a class="permalink" href="index.html#LogRecordHeader">&#xb6;</a>
				
				
			</h2>
			<p>
LogRecordHeader contains the LogRecordLength (lower 32 bits) and LogRecordCRC (upper 32 bits).
</p>

			<pre>type LogRecordHeader <a href="http://localhost:6060/pkg/builtin/#uint64">uint64</a></pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="LogRecordLength">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=1090:1117#L41">LogRecordLength</a>
				<a class="permalink" href="index.html#LogRecordLength">&#xb6;</a>
				
				
			</h2>
			
			<pre>type LogRecordLength <a href="http://localhost:6060/pkg/builtin/#uint32">uint32</a></pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="LogRecordReader">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go?s=316:421#L11">LogRecordReader</a>
				<a class="permalink" href="index.html#LogRecordReader">&#xb6;</a>
				
				
			</h2>
			
			<pre>type LogRecordReader struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewLogRecordReader">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go?s=423:508#L18">NewLogRecordReader</a>
					<a class="permalink" href="index.html#NewLogRecordReader">&#xb6;</a>
					
					
				</h3>
				<pre>func NewLogRecordReader(logger <a href="../api/index.html">api</a>.<a href="../api/index.html#Logger">Logger</a>, fileName <a href="http://localhost:6060/pkg/builtin/#string">string</a>) (*<a href="index.html#LogRecordReader">LogRecordReader</a>, <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				
				
				
			

			
				
				<h3 id="LogRecordReader.CRC">func (*LogRecordReader) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go?s=1764:1802#L84">CRC</a>
					<a class="permalink" href="index.html#LogRecordReader.CRC">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="index.html#LogRecordReader">LogRecordReader</a>) CRC() <a href="http://localhost:6060/pkg/builtin/#uint32">uint32</a></pre>
				
				
				
				
			
				
				<h3 id="LogRecordReader.Close">func (*LogRecordReader) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go?s=1530:1569#L70">Close</a>
					<a class="permalink" href="index.html#LogRecordReader.Close">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="index.html#LogRecordReader">LogRecordReader</a>) Close() <a href="http://localhost:6060/pkg/builtin/#error">error</a></pre>
				
				
				
				
			
				
				<h3 id="LogRecordReader.Read">func (*LogRecordReader) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/reader.go?s=1822:1881#L88">Read</a>
					<a class="permalink" href="index.html#LogRecordReader.Read">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="index.html#LogRecordReader">LogRecordReader</a>) Read() (*<a href="../../smartbftprotos/index.html">protos</a>.<a href="../../smartbftprotos/index.html#LogRecord">LogRecord</a>, <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				
				
				
				
			
		
			
			
			<h2 id="Options">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=2605:2674#L86">Options</a>
				<a class="permalink" href="index.html#Options">&#xb6;</a>
				
				
			</h2>
			
			<pre>type Options struct {
<span id="Options.FileSizeBytes"></span>    FileSizeBytes   <a href="http://localhost:6060/pkg/builtin/#int64">int64</a>
<span id="Options.BufferSizeBytes"></span>    BufferSizeBytes <a href="http://localhost:6060/pkg/builtin/#int64">int64</a>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="DefaultOptions">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=2730:2760#L92">DefaultOptions</a>
					<a class="permalink" href="index.html#DefaultOptions">&#xb6;</a>
					
					
				</h3>
				<pre>func DefaultOptions() *<a href="index.html#Options">Options</a></pre>
				<p>
DefaultOptions returns the set of default options.
</p>

				
				
			

			
				
				<h3 id="Options.String">func (*Options) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=2871:2904#L99">String</a>
					<a class="permalink" href="index.html#Options.String">&#xb6;</a>
					
					
				</h3>
				<pre>func (o *<a href="index.html#Options">Options</a>) String() <a href="http://localhost:6060/pkg/builtin/#string">string</a></pre>
				
				
				
				
			
		
			
			
			<h2 id="WriteAheadLogFile">type <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=2280:2603#L68">WriteAheadLogFile</a>
				<a class="permalink" href="index.html#WriteAheadLogFile">&#xb6;</a>
				
				
			</h2>
			<p>
WriteAheadLogFile is a simple implementation of a write ahead log (WAL).
</p>
<p>
The WAL is composed of a sequence of frames. Each frame contains:
- a header (uint64)
- payload: a record of type LogRecord, marshaled to bytes, and padded with zeros to 8B boundary.
</p>
<p>
The 64 bit header is made of two parts:
- length of the marshaled LogRecord (not including pad bytes), in the lower 32 bits.
- a crc32 of the data: marshaled record bytes + pad bytes, in the upper 32 bits.
</p>
<p>
The WAL is written to a sequence of files: &lt;index&gt;.wal, where index uint64=1,2,3...; represented in fixed-width
hex format, e.g. 0000000000000001.wal
</p>
<p>
The WAL has two modes: append, and read.
</p>
<p>
When a WAL is first created, it is in append mode.
When an existing WAL is opened, it is in read mode, and will change to append mode only after ReadAll() is invoked.
</p>
<p>
In append mode the WAL can accept Append() and TruncateTo() calls.
The WAL must be closed after use to release all resources.
</p>

			<pre>type WriteAheadLogFile struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="Create">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=3353:3445#L110">Create</a>
					<a class="permalink" href="index.html#Create">&#xb6;</a>
					
					
				</h3>
				<pre>func Create(logger <a href="../api/index.html">api</a>.<a href="../api/index.html#Logger">Logger</a>, dirPath <a href="http://localhost:6060/pkg/builtin/#string">string</a>, options *<a href="index.html#Options">Options</a>) (*<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>, <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				<p>
Create will create a new WAL, if it does not exist, or an error if it already exists.
</p>
<p>
logger: reference to a Logger implementation.
dirPath: directory path of the WAL.
options: a structure containing Options, or nil, for default options.
</p>
<p>
return: pointer to a WAL, ErrWALAlreadyExists if WAL already exists or other errors
</p>

				
				
			
				
				<h3 id="InitializeAndReadAll">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=19164:19310#L650">InitializeAndReadAll</a>
					<a class="permalink" href="index.html#InitializeAndReadAll">&#xb6;</a>
					
					
				</h3>
				<pre>func InitializeAndReadAll(logger <a href="../api/index.html">api</a>.<a href="../api/index.html#Logger">Logger</a>, walDir <a href="http://localhost:6060/pkg/builtin/#string">string</a>, options *<a href="index.html#Options">Options</a>) (writeAheadLog *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>, initialState [][]<a href="http://localhost:6060/pkg/builtin/#byte">byte</a>, err <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				
				
				
			
				
				<h3 id="Open">func <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=5322:5412#L174">Open</a>
					<a class="permalink" href="index.html#Open">&#xb6;</a>
					
					
				</h3>
				<pre>func Open(logger <a href="../api/index.html">api</a>.<a href="../api/index.html#Logger">Logger</a>, dirPath <a href="http://localhost:6060/pkg/builtin/#string">string</a>, options *<a href="index.html#Options">Options</a>) (*<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>, <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				<p>
Open will open an existing WAL, if it exists, or an error if it does not exist.
</p>
<p>
After opening, the WAL is in read mode, and expects a call to ReadAll(). An attempt to write
(e.g. Append, TruncateTo) will result in an error.
</p>
<p>
logger: reference to a Logger implementation.
dirPath: directory path of the WAL.
options: a structure containing Options, or nil, for default options.
</p>
<p>
return: pointer to a WAL, or an error
</p>

				
				
			

			
				
				<h3 id="WriteAheadLogFile.Append">func (*WriteAheadLogFile) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=10580:10650#L344">Append</a>
					<a class="permalink" href="index.html#WriteAheadLogFile.Append">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>) Append(data []<a href="http://localhost:6060/pkg/builtin/#byte">byte</a>, truncateTo <a href="http://localhost:6060/pkg/builtin/#bool">bool</a>) <a href="http://localhost:6060/pkg/builtin/#error">error</a></pre>
				<p>
Append a data item to the end of the WAL and indicate whether this entry is a truncation point.
</p>
<p>
The data item will be added to the log, and internally marked with a flag that indicates whether
it is a truncation point. The log implementation may truncate all preceding data items, not including this one.
</p>
<p>
data: the data to be appended to the log. Cannot be nil or empty.
truncateTo: whether all records preceding this one, but not including it, can be truncated from the log.
</p>

				
				
				
			
				
				<h3 id="WriteAheadLogFile.CRC">func (*WriteAheadLogFile) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=9605:9645#L316">CRC</a>
					<a class="permalink" href="index.html#WriteAheadLogFile.CRC">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>) CRC() <a href="http://localhost:6060/pkg/builtin/#uint32">uint32</a></pre>
				<p>
CRC returns the last CRC written to the log file.
</p>

				
				
				
			
				
				<h3 id="WriteAheadLogFile.Close">func (*WriteAheadLogFile) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=8925:8966#L283">Close</a>
					<a class="permalink" href="index.html#WriteAheadLogFile.Close">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>) Close() <a href="http://localhost:6060/pkg/builtin/#error">error</a></pre>
				<p>
Close the files and directory of the WAL, and release all resources.
</p>

				
				
				
			
				
				<h3 id="WriteAheadLogFile.ReadAll">func (*WriteAheadLogFile) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=13353:13408#L437">ReadAll</a>
					<a class="permalink" href="index.html#WriteAheadLogFile.ReadAll">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>) ReadAll() ([][]<a href="http://localhost:6060/pkg/builtin/#byte">byte</a>, <a href="http://localhost:6060/pkg/builtin/#error">error</a>)</pre>
				<p>
ReadAll the data items from the latest truncation point to the end of the log.
This method can be called only at the beginning of the WAL lifecycle, right after Open().
After a successful invocation the WAL moves to write mode, and is ready to Append().
</p>
<p>
In case of failure:
</p>
<pre>- an error of type io.ErrUnexpectedEOF	is returned when the WAL can possibly be repaired by truncating the last
  log file after the last good record.
- all other errors indicate that the WAL is either
	- is closed, or
	- is in write mode, or
	- is corrupted beyond the simple repair measure described above.
</pre>

				
				
				
			
				
				<h3 id="WriteAheadLogFile.TruncateTo">func (*WriteAheadLogFile) <a href="http://localhost:6060/src/github.com/SmartBFT-Go/consensus/pkg/wal/writeaheadlog.go?s=9871:9917#L325">TruncateTo</a>
					<a class="permalink" href="index.html#WriteAheadLogFile.TruncateTo">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WriteAheadLogFile">WriteAheadLogFile</a>) TruncateTo() <a href="http://localhost:6060/pkg/builtin/#error">error</a></pre>
				<p>
TruncateTo appends a control record in which the TruncateTo flag is true.
This marks that every record prior to this one can be safely truncated from the log.
</p>

				
				
				
			
		
	

	







<div id="footer">
Build version go1.11.5.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="http://localhost:6060/doc/tos.html">Terms of Service</a> |
<a href="http://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->

</body>
</html>

